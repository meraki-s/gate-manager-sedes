<div
  class="container"
  [ngClass]="isMobile ? 'container--mobile' : 'container--desktop'"
>
  <div class="search-container">
    <mat-form-field
      appearance="fill"
      class="search-input"
      [ngClass]="isMobile ? 'search-input--mobile' : 'search-input--desktop'"
    >
      <mat-label>Desde - Hasta</mat-label>
      <mat-date-range-input [formGroup]="dateForm" [rangePicker]="picker">
        <input
          readonly
          matStartDate
          formControlName="start"
          placeholder="Fecha Inicio"
        />
        <input
          readonly
          matEndDate
          formControlName="end"
          placeholder="Fecha Final"
        />
      </mat-date-range-input>
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-date-range-picker #picker></mat-date-range-picker>
    </mat-form-field>
    <mat-form-field
      appearance="fill"
      class="search-input"
      [ngClass]="isMobile ? 'search-input--mobile' : 'search-input--desktop'"
    >
      <mat-label>Filtro por DNI</mat-label>
      <input
        matInput
        [formControl]="dniControl"
        type="text"
        placeholder="Número de DNI"
        autocomplete="off"
      />
    </mat-form-field>
    <mat-form-field
      appearance="fill"
      class="search-input"
      [ngClass]="isMobile ? 'search-input--mobile' : 'search-input--desktop'"
    >
      <mat-label>Filtro por RUC</mat-label>
      <input
        matInput
        [formControl]="rucControl"
        type="text"
        placeholder="Número de RUC"
        autocomplete="off"
      />
    </mat-form-field>
  </div>
  <div
    class="events-container"
    [ngClass]="isMobile ? 'events-container--mobile' : ''"
    *ngIf="eventsActivity$ | async"
  >
    <div class="table-header">
      <h3>Historial</h3>
      <span class="fill"></span>
      <button
        mat-raised-button
        color="primary"
        style="color: white"
        (click)="downloadXlsx(events)"
      >
        <mat-icon>download</mat-icon>
        Descargar
      </button>
    </div>
    <table
      mat-table
      [dataSource]="eventsDataSource"
      matSort
      (matSortChange)="sortData($event)"
    >
      <ng-container matColumnDef="date">
        <th
          mat-header-cell
          *matHeaderCellDef
          class="table__cell"
          mat-sort-header
        >
          Fecha
        </th>
        <td mat-cell *matCellDef="let element" class="table__cell">
          <span
            >{{ element.createdAt.seconds * 1000 | date : "dd/MM/yy" }}
          </span>
          <br />
          <span class="date-hours">
            {{ element.createdAt.seconds * 1000 | date : "hh:mm:ss" }}
          </span>
        </td>
      </ng-container>
      <ng-container matColumnDef="createdBy">
        <th
          mat-header-cell
          *matHeaderCellDef
          class="table__cell"
          mat-sort-header
        >
          Creado por
        </th>
        <td mat-cell *matCellDef="let element" class="table__cell">
          {{ element.createdBy.displayName }}
        </td>
      </ng-container>
      <ng-container matColumnDef="collaboratorName">
        <th
          mat-header-cell
          *matHeaderCellDef
          class="table__cell"
          mat-sort-header
        >
          Nombre
        </th>
        <td mat-cell *matCellDef="let element" class="table__cell">
          {{ element.collaboratorName }}
        </td>
      </ng-container>
      <ng-container matColumnDef="collaboratorDNI">
        <th
          mat-header-cell
          *matHeaderCellDef
          class="table__cell"
          mat-sort-header
        >
          DNI
        </th>
        <td mat-cell *matCellDef="let element" class="table__cell">
          {{ element.collaboratorDNI }}
        </td>
      </ng-container>
      <ng-container matColumnDef="providerName">
        <th
          mat-header-cell
          *matHeaderCellDef
          class="table__cell"
          mat-sort-header
        >
          Empresa
        </th>
        <td mat-cell *matCellDef="let element" class="table__cell">
          {{ element.providerName }}
        </td>
      </ng-container>
      <ng-container matColumnDef="providerRUC">
        <th
          mat-header-cell
          *matHeaderCellDef
          class="table__cell"
          mat-sort-header
        >
          RUC
        </th>
        <td mat-cell *matCellDef="let element" class="table__cell">
          {{ element.providerRUC }}
        </td>
      </ng-container>
      <ng-container matColumnDef="activity">
        <th
          mat-header-cell
          *matHeaderCellDef
          class="table__cell"
          mat-sort-header
        >
          Evento
        </th>
        <td mat-cell *matCellDef="let element" class="table__cell">
          {{ element.activity }}
        </td>
      </ng-container>
      <ng-container matColumnDef="description">
        <th
          mat-header-cell
          *matHeaderCellDef
          class="table__cell"
          mat-sort-header
        >
          Descripción
        </th>
        <td mat-cell *matCellDef="let element" class="table__cell">
          {{ element.description }}
        </td>
      </ng-container>
      <tr
        mat-header-row
        *matHeaderRowDef="eventsDisplayedColumns; sticky: true"
      ></tr>
      <tr
        mat-row
        *matRowDef="let element; columns: eventsDisplayedColumns"
      ></tr>

      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="4">No hay eventos registrados</td>
      </tr>
    </table>
    <mat-paginator
      #eventsPaginator
      [pageSizeOptions]="[5, 25, 50]"
      showFirstLastButtons
    ></mat-paginator>
  </div>
</div>
