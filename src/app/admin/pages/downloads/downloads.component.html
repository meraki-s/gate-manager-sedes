<div class="downloads-container">
  <div class="page-header">
    <h1 class="page-title">Descargas Masivas</h1>
    <p class="page-description">
      Descarga reportes completos con información de todos los proveedores, colaboradores y documentos del sistema
    </p>
  </div>

  <div class="downloads-grid">
    <!-- Providers and Documents Report Card -->
    <mat-card class="download-card mat-elevation-z2">
      <mat-card-header>
        <mat-icon mat-card-avatar class="card-icon">
          description
        </mat-icon>
        <mat-card-title>Proveedores y Documentos</mat-card-title>
        <mat-card-subtitle>
          Reporte completo de todos los proveedores y sus documentos
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <div class="card-details">
          <div class="detail-item">
            <mat-icon class="detail-icon">business</mat-icon>
            <span>Todos los proveedores registrados</span>
          </div>
          <div class="detail-item">
            <mat-icon class="detail-icon">folder</mat-icon>
            <span>Documentos por categoría (IPERC, ATS, PETS, etc.)</span>
          </div>
          <div class="detail-item">
            <mat-icon class="detail-icon">info</mat-icon>
            <span>Estados, fechas de validez y URLs de documentos</span>
          </div>
          <div class="detail-item">
            <mat-icon class="detail-icon">person</mat-icon>
            <span>Información de creación y actualización</span>
          </div>
        </div>

        <!-- Progress indicator for providers report -->
        <div
          *ngIf="isGeneratingProvidersReport$ | async"
          class="download-progress"
        >
          <div class="progress-info">
            <span class="progress-message">{{
              downloadProgressMessage$ | async
            }}</span>
            <span class="progress-percentage"
              >{{ downloadProgressPercentage$ | async }}%</span
            >
          </div>
          <mat-progress-bar
            mode="determinate"
            [value]="downloadProgressPercentage$ | async"
            color="accent"
          ></mat-progress-bar>
        </div>
      </mat-card-content>

      <mat-card-actions>
        <button
          mat-raised-button
          color="accent"
          (click)="onDownloadProvidersReport()"
          [disabled]="(isGeneratingProvidersReport$ | async) || false"
          class="download-button"
        >
          <mat-icon *ngIf="!(isGeneratingProvidersReport$ | async)"
            >download</mat-icon
          >
          <mat-spinner
            *ngIf="isGeneratingProvidersReport$ | async"
            diameter="20"
            style="display: inline-block; margin-right: 8px"
          ></mat-spinner>
          {{
            (isGeneratingProvidersReport$ | async)
              ? "Generando..."
              : "Descargar Excel"
          }}
        </button>
      </mat-card-actions>
    </mat-card>

    <!-- Collaborators Report Card -->
    <mat-card class="download-card mat-elevation-z2">
      <mat-card-header>
        <mat-icon mat-card-avatar class="card-icon">
          groups
        </mat-icon>
        <mat-card-title>Colaboradores</mat-card-title>
        <mat-card-subtitle>
          Reporte completo de todos los colaboradores
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <div class="card-details">
          <div class="detail-item">
            <mat-icon class="detail-icon">badge</mat-icon>
            <span>Información personal de colaboradores</span>
          </div>
          <div class="detail-item">
            <mat-icon class="detail-icon">work</mat-icon>
            <span>Cargo y empresa asociada</span>
          </div>
          <div class="detail-item">
            <mat-icon class="detail-icon">health_and_safety</mat-icon>
            <span>Estado de documentos (SCTR, SVL, Inducción, LOTO)</span>
          </div>
          <div class="detail-item">
            <mat-icon class="detail-icon">link</mat-icon>
            <span>URLs de archivos adjuntos</span>
          </div>
        </div>

        <!-- Loading indicator for collaborators report -->
        <div
          *ngIf="isGeneratingCollaboratorsReport$ | async"
          class="loading-indicator"
        >
          <mat-spinner diameter="30"></mat-spinner>
          <span>Generando reporte de colaboradores...</span>
        </div>
      </mat-card-content>

      <mat-card-actions>
        <button
          mat-raised-button
          color="primary"
          (click)="onDownloadCollaboratorsReport()"
          [disabled]="(isGeneratingCollaboratorsReport$ | async) || false"
          class="download-button"
        >
          <mat-icon *ngIf="!(isGeneratingCollaboratorsReport$ | async)"
            >download</mat-icon
          >
          <mat-spinner
            *ngIf="isGeneratingCollaboratorsReport$ | async"
            diameter="20"
            style="display: inline-block; margin-right: 8px"
          ></mat-spinner>
          {{
            (isGeneratingCollaboratorsReport$ | async)
              ? "Generando..."
              : "Descargar Excel"
          }}
        </button>
      </mat-card-actions>
    </mat-card>
  </div>

  <div class="info-section">
    <mat-icon class="info-icon">info</mat-icon>
    <div class="info-content">
      <h3>Información importante</h3>
      <ul>
        <li>
          Los reportes pueden tardar varios minutos en generarse dependiendo de
          la cantidad de datos
        </li>
        <li>
          El reporte de Proveedores y Documentos incluye seguimiento de
          progreso en tiempo real
        </li>
        <li>Los archivos Excel se generan con columnas autoajustadas</li>
        <li>
          Las URLs de documentos están incluidas para acceso directo a los
          archivos
        </li>
      </ul>
    </div>
  </div>
</div>
